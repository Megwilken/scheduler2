{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.splitPath = void 0;\n\nrequire(\"core-js/modules/es7.symbol.async-iterator\");\n\nrequire(\"core-js/modules/es6.object.define-properties\");\n\nrequire(\"core-js/modules/es6.object.freeze\");\n\nrequire(\"core-js/modules/es6.symbol\");\n\nrequire(\"core-js/modules/es6.array.index-of\");\n\nrequire(\"core-js/modules/es6.object.define-property\");\n\nrequire(\"core-js/modules/es6.object.create\");\n\nrequire(\"core-js/modules/es6.object.set-prototype-of\");\n\nrequire(\"core-js/modules/es6.array.for-each\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nrequire(\"core-js/modules/es6.function.name\");\n\nrequire(\"core-js/modules/es7.object.values\");\n\nrequire(\"core-js/modules/es6.array.map\");\n\nrequire(\"core-js/modules/es6.regexp.search\");\n\nrequire(\"core-js/modules/es6.array.sort\");\n\nrequire(\"core-js/modules/es6.array.is-array\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es6.object.to-string\");\n\nrequire(\"core-js/modules/es7.object.entries\");\n\nrequire(\"core-js/modules/es6.array.reduce\");\n\nrequire(\"core-js/modules/es6.array.filter\");\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nrequire(\"core-js/modules/es6.object.assign\");\n\nrequire(\"core-js/modules/es6.regexp.replace\");\n\nvar _global = require(\"global\");\n\nvar _eventemitter = _interopRequireDefault(require(\"eventemitter3\"));\n\nvar _qs = _interopRequireDefault(require(\"qs\"));\n\nvar _memoizerific = _interopRequireDefault(require(\"memoizerific\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash.debounce\"));\n\nvar _commonTags = require(\"common-tags\");\n\nvar _coreEvents = _interopRequireDefault(require(\"@storybook/core-events\"));\n\nvar _clientLogger = require(\"@storybook/client-logger\");\n\nvar _utils = require(\"@storybook/router/utils\");\n\nvar _pathToId = _interopRequireDefault(require(\"./pathToId\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n        Story with id \", \" already exists in the store!\\n\\n        Perhaps you added the same story twice, or you have a name collision?\\n        Story ids need to be unique -- ensure you aren't using the same names modolo url-sanitization.\\n      \"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _taggedTemplateLiteral(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n} // TODO: these are copies from components/nav/lib\n// refactor to DRY\n\n\nvar toKey = function toKey(input) {\n  return input.replace(/[^a-z0-9]+([a-z0-9])/gi, function () {\n    for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {\n      params[_key] = arguments[_key];\n    }\n\n    return params[1].toUpperCase();\n  });\n};\n\nvar toChild = function toChild(it) {\n  return Object.assign({}, it);\n};\n\nvar splitPath = function splitPath(path, _ref) {\n  var rootSeparator = _ref.rootSeparator,\n      groupSeparator = _ref.groupSeparator;\n\n  var _path$split = path.split(rootSeparator, 2),\n      _path$split2 = _slicedToArray(_path$split, 2),\n      root = _path$split2[0],\n      remainder = _path$split2[1];\n\n  var groups = (remainder || path).split(groupSeparator).filter(function (i) {\n    return !!i;\n  }); // when there's no remainder, it means the root wasn't found/split\n\n  return {\n    root: remainder ? root : null,\n    groups: groups\n  };\n};\n\nexports.splitPath = splitPath;\nvar count = 0;\n\nfunction getId() {\n  count += 1;\n  return count;\n}\n\nvar toExtracted = function toExtracted(obj) {\n  return Object.entries(obj).reduce(function (acc, _ref2) {\n    var _ref3 = _slicedToArray(_ref2, 2),\n        key = _ref3[0],\n        value = _ref3[1];\n\n    if (typeof value === 'function') {\n      return acc;\n    }\n\n    if (Array.isArray(value)) {\n      return Object.assign(acc, _defineProperty({}, key, value.slice().sort()));\n    }\n\n    return Object.assign(acc, _defineProperty({}, key, value));\n  }, {});\n};\n\nvar getIdFromLegacyQuery = function getIdFromLegacyQuery(_ref4) {\n  var path = _ref4.path,\n      selectedKind = _ref4.selectedKind,\n      selectedStory = _ref4.selectedStory;\n  return path && (0, _pathToId.default)(path) || selectedKind && selectedStory && (0, _utils.toId)(selectedKind, selectedStory);\n};\n\nvar StoryStore = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(StoryStore, _EventEmitter);\n\n  function StoryStore(_ref5) {\n    var _this;\n\n    var channel = _ref5.channel;\n\n    _classCallCheck(this, StoryStore);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(StoryStore).call(this));\n\n    _this.getIdOnPath = function () {\n      var _qs$parse = _qs.default.parse(_global.document.location.search, {\n        ignoreQueryPrefix: true\n      }),\n          id = _qs$parse.id;\n\n      return id;\n    };\n\n    _this.setPath = function (storyId) {\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var path = \"\".concat(_global.document.location.pathname, \"?\").concat(_qs.default.stringify(Object.assign({}, params, {\n        id: storyId\n      })));\n\n      _global.history.replaceState({}, '', path);\n    };\n\n    _this.fromId = function (id) {\n      try {\n        var data = _this._data[id];\n\n        if (!data || !data.getDecorated) {\n          return null;\n        }\n\n        return data;\n      } catch (e) {\n        _clientLogger.logger.warn('failed to get story:', _this._data);\n\n        _clientLogger.logger.error(e);\n\n        return {};\n      }\n    };\n\n    _this.setSelection = function (data) {\n      _this._selection = data;\n      setTimeout(function () {\n        return _this.emit(_coreEvents.default.STORY_RENDER);\n      }, 1);\n    };\n\n    _this.getSelection = function () {\n      return _this._selection;\n    };\n\n    _this.remove = function (id) {\n      var _assertThisInitialize = _assertThisInitialized(_this),\n          _data = _assertThisInitialize._data;\n\n      delete _data[id];\n    };\n\n    _this.pushToManager = (0, _lodash.default)(function () {\n      if (_this._channel) {\n        var stories = _this.extract(); // send to the parent frame.\n\n\n        _this._channel.emit(_coreEvents.default.SET_STORIES, {\n          stories: stories\n        });\n      }\n    }, 0);\n    _this._legacydata = {};\n    _this._data = {};\n    _this._revision = 0;\n    _this._selection = {};\n    _this._channel = channel;\n\n    _this.on(_coreEvents.default.STORY_INIT, function () {\n      var storyId = _this.getIdOnPath();\n\n      if (!storyId) {\n        var params = _qs.default.parse(_global.document.location.search, {\n          ignoreQueryPrefix: true\n        });\n\n        storyId = getIdFromLegacyQuery(params);\n\n        if (storyId) {\n          var path = params.path,\n              selectedKind = params.selectedKind,\n              selectedStory = params.selectedStory,\n              rest = _objectWithoutProperties(params, [\"path\", \"selectedKind\", \"selectedStory\"]);\n\n          _this.setPath(storyId, rest);\n        }\n      }\n\n      _this.setSelection(_this.fromId(storyId));\n    });\n\n    return _this;\n  } // NEW apis\n\n\n  _createClass(StoryStore, [{\n    key: \"setSeparators\",\n    value: function setSeparators(data) {\n      this.separators = data;\n    }\n  }, {\n    key: \"raw\",\n    value: function raw() {\n      var _this2 = this;\n\n      return Object.values(this._data).filter(function (i) {\n        return !!i.getDecorated;\n      }).map(function (_ref6) {\n        var id = _ref6.id;\n        return _this2.fromId(id);\n      });\n    }\n  }, {\n    key: \"extract\",\n    value: function extract() {\n      // removes function values from all stories so they are safe to transport over the channel\n      return Object.entries(this._data).reduce(function (a, _ref7) {\n        var _ref8 = _slicedToArray(_ref7, 2),\n            k = _ref8[0],\n            v = _ref8[1];\n\n        return Object.assign(a, _defineProperty({}, k, toExtracted(v)));\n      }, {});\n    }\n  }, {\n    key: \"addStory\",\n    value: function addStory(_ref9, _ref10) {\n      var id = _ref9.id,\n          kind = _ref9.kind,\n          name = _ref9.name,\n          original = _ref9.storyFn,\n          _ref9$parameters = _ref9.parameters,\n          parameters = _ref9$parameters === void 0 ? {} : _ref9$parameters;\n      var getDecorators = _ref10.getDecorators,\n          applyDecorators = _ref10.applyDecorators;\n      var _data = this._data;\n\n      if (_data[id]) {\n        _clientLogger.logger.warn((0, _commonTags.stripIndents)(_templateObject(), id));\n      }\n\n      var identification = {\n        id: id,\n        kind: kind,\n        name: name,\n        story: name // legacy\n\n      }; // immutable original storyFn\n\n      var getOriginal = function getOriginal() {\n        return original;\n      }; // lazily decorate the story when it's loaded\n\n\n      var getDecorated = (0, _memoizerific.default)(1)(function () {\n        return applyDecorators(getOriginal(), getDecorators());\n      });\n\n      var storyFn = function storyFn(p) {\n        return getDecorated()(Object.assign({}, identification, {\n          parameters: Object.assign({}, parameters, p)\n        }));\n      };\n\n      _data[id] = toChild(Object.assign({}, identification, {\n        getDecorated: getDecorated,\n        getOriginal: getOriginal,\n        storyFn: storyFn,\n        parameters: parameters\n      })); // LEGACY DATA\n\n      this.addLegacyStory({\n        kind: kind,\n        name: name,\n        storyFn: storyFn,\n        parameters: parameters\n      }); // LET'S SEND IT TO THE MANAGER\n\n      this.pushToManager();\n    }\n  }, {\n    key: \"getRevision\",\n    // OLD apis\n    value: function getRevision() {\n      return this._revision;\n    }\n  }, {\n    key: \"incrementRevision\",\n    value: function incrementRevision() {\n      this._revision += 1;\n    }\n  }, {\n    key: \"addLegacyStory\",\n    value: function addLegacyStory(_ref11) {\n      var kind = _ref11.kind,\n          name = _ref11.name,\n          storyFn = _ref11.storyFn,\n          _ref11$parameters = _ref11.parameters,\n          parameters = _ref11$parameters === void 0 ? {} : _ref11$parameters;\n      var k = toKey(kind);\n\n      if (!this._legacydata[k]) {\n        this._legacydata[k] = {\n          kind: kind,\n          fileName: parameters.fileName,\n          index: getId(),\n          stories: {}\n        };\n      }\n\n      this._legacydata[k].stories[toKey(name)] = {\n        name: name,\n        // kind,\n        index: getId(),\n        story: storyFn,\n        parameters: parameters\n      };\n    }\n  }, {\n    key: \"getStoryKinds\",\n    value: function getStoryKinds() {\n      return Object.values(this._legacydata).filter(function (kind) {\n        return Object.keys(kind.stories).length > 0;\n      }).sort(function (info1, info2) {\n        return info1.index - info2.index;\n      }).map(function (info) {\n        return info.kind;\n      });\n    }\n  }, {\n    key: \"getStories\",\n    value: function getStories(kind) {\n      var _this3 = this;\n\n      var key = toKey(kind);\n\n      if (!this._legacydata[key]) {\n        return [];\n      }\n\n      return Object.keys(this._legacydata[key].stories).map(function (name) {\n        return _this3._legacydata[key].stories[name];\n      }).sort(function (info1, info2) {\n        return info1.index - info2.index;\n      }).map(function (info) {\n        return info.name;\n      });\n    }\n  }, {\n    key: \"getStoryFileName\",\n    value: function getStoryFileName(kind) {\n      var key = toKey(kind);\n      var storiesKind = this._legacydata[key];\n\n      if (!storiesKind) {\n        return null;\n      }\n\n      return storiesKind.fileName;\n    }\n  }, {\n    key: \"getStoryAndParameters\",\n    value: function getStoryAndParameters(kind, name) {\n      if (!kind || !name) {\n        return null;\n      }\n\n      var storiesKind = this._legacydata[toKey(kind)];\n\n      if (!storiesKind) {\n        return null;\n      }\n\n      var storyInfo = storiesKind.stories[toKey(name)];\n\n      if (!storyInfo) {\n        return null;\n      }\n\n      var story = storyInfo.story,\n          parameters = storyInfo.parameters;\n      return {\n        story: story,\n        parameters: parameters\n      };\n    }\n  }, {\n    key: \"getStory\",\n    value: function getStory(kind, name) {\n      var data = this.getStoryAndParameters(kind, name);\n      return data && data.story;\n    }\n  }, {\n    key: \"getStoryWithContext\",\n    value: function getStoryWithContext(kind, name) {\n      var data = this.getStoryAndParameters(kind, name);\n\n      if (!data) {\n        return null;\n      }\n\n      var story = data.story;\n      return story;\n    }\n  }, {\n    key: \"removeStoryKind\",\n    value: function removeStoryKind(kind) {\n      if (this.hasStoryKind(kind)) {\n        this._legacydata[toKey(kind)].stories = {};\n      }\n    }\n  }, {\n    key: \"hasStoryKind\",\n    value: function hasStoryKind(kind) {\n      return Boolean(this._legacydata[toKey(kind)]);\n    }\n  }, {\n    key: \"hasStory\",\n    value: function hasStory(kind, name) {\n      return Boolean(this.getStory(kind, name));\n    }\n  }, {\n    key: \"dumpStoryBook\",\n    value: function dumpStoryBook() {\n      var _this4 = this;\n\n      var data = this.getStoryKinds().map(function (kind) {\n        return {\n          kind: kind,\n          stories: _this4.getStories(kind)\n        };\n      });\n      return data;\n    }\n  }, {\n    key: \"size\",\n    value: function size() {\n      return Object.keys(this._legacydata).length;\n    }\n  }, {\n    key: \"clean\",\n    value: function clean() {\n      var _this5 = this;\n\n      this.getStoryKinds().forEach(function (kind) {\n        return delete _this5._legacydata[toKey(kind)];\n      });\n    }\n  }]);\n\n  return StoryStore;\n}(_eventemitter.default);\n\nexports.default = StoryStore;","map":{"version":3,"names":["Object","defineProperty","exports","value","default","splitPath","require","_global","_eventemitter","_interopRequireDefault","_qs","_memoizerific","_lodash","_commonTags","_coreEvents","_clientLogger","_utils","_pathToId","obj","__esModule","_typeof","Symbol","iterator","constructor","prototype","_templateObject","data","_taggedTemplateLiteral","strings","raw","slice","freeze","defineProperties","_objectWithoutProperties","source","excluded","target","_objectWithoutPropertiesLoose","key","i","getOwnPropertySymbols","sourceSymbolKeys","length","indexOf","propertyIsEnumerable","call","sourceKeys","keys","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","enumerable","configurable","writable","_createClass","protoProps","staticProps","_possibleConstructorReturn","self","_assertThisInitialized","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","ReferenceError","_inherits","subClass","superClass","create","_setPrototypeOf","p","_defineProperty","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","_arr","_n","_d","_e","undefined","_i","_s","next","done","push","err","Array","isArray","toKey","input","replace","_len","arguments","params","_key","toUpperCase","toChild","it","assign","path","_ref","rootSeparator","groupSeparator","_path$split","split","_path$split2","root","remainder","groups","filter","count","getId","toExtracted","entries","reduce","acc","_ref2","_ref3","sort","getIdFromLegacyQuery","_ref4","selectedKind","selectedStory","toId","StoryStore","_EventEmitter","_ref5","_this","channel","getIdOnPath","_qs$parse","parse","document","location","search","ignoreQueryPrefix","id","setPath","storyId","concat","pathname","stringify","history","replaceState","fromId","_data","getDecorated","e","logger","warn","error","setSelection","_selection","setTimeout","emit","STORY_RENDER","getSelection","remove","_assertThisInitialize","pushToManager","_channel","stories","extract","SET_STORIES","_legacydata","_revision","on","STORY_INIT","rest","setSeparators","separators","_this2","values","map","_ref6","a","_ref7","_ref8","k","v","addStory","_ref9","_ref10","kind","name","original","storyFn","_ref9$parameters","parameters","getDecorators","applyDecorators","stripIndents","identification","story","getOriginal","addLegacyStory","getRevision","incrementRevision","_ref11","_ref11$parameters","fileName","index","getStoryKinds","info1","info2","info","getStories","_this3","getStoryFileName","storiesKind","getStoryAndParameters","storyInfo","getStory","getStoryWithContext","removeStoryKind","hasStoryKind","Boolean","hasStory","dumpStoryBook","_this4","size","clean","_this5","forEach"],"sources":["/Users/megwilken/lighthouse/scheduler2/node_modules/@storybook/client-api/dist/story_store.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.splitPath = void 0;\n\nrequire(\"core-js/modules/es7.symbol.async-iterator\");\n\nrequire(\"core-js/modules/es6.object.define-properties\");\n\nrequire(\"core-js/modules/es6.object.freeze\");\n\nrequire(\"core-js/modules/es6.symbol\");\n\nrequire(\"core-js/modules/es6.array.index-of\");\n\nrequire(\"core-js/modules/es6.object.define-property\");\n\nrequire(\"core-js/modules/es6.object.create\");\n\nrequire(\"core-js/modules/es6.object.set-prototype-of\");\n\nrequire(\"core-js/modules/es6.array.for-each\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nrequire(\"core-js/modules/es6.function.name\");\n\nrequire(\"core-js/modules/es7.object.values\");\n\nrequire(\"core-js/modules/es6.array.map\");\n\nrequire(\"core-js/modules/es6.regexp.search\");\n\nrequire(\"core-js/modules/es6.array.sort\");\n\nrequire(\"core-js/modules/es6.array.is-array\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es6.object.to-string\");\n\nrequire(\"core-js/modules/es7.object.entries\");\n\nrequire(\"core-js/modules/es6.array.reduce\");\n\nrequire(\"core-js/modules/es6.array.filter\");\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nrequire(\"core-js/modules/es6.object.assign\");\n\nrequire(\"core-js/modules/es6.regexp.replace\");\n\nvar _global = require(\"global\");\n\nvar _eventemitter = _interopRequireDefault(require(\"eventemitter3\"));\n\nvar _qs = _interopRequireDefault(require(\"qs\"));\n\nvar _memoizerific = _interopRequireDefault(require(\"memoizerific\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash.debounce\"));\n\nvar _commonTags = require(\"common-tags\");\n\nvar _coreEvents = _interopRequireDefault(require(\"@storybook/core-events\"));\n\nvar _clientLogger = require(\"@storybook/client-logger\");\n\nvar _utils = require(\"@storybook/router/utils\");\n\nvar _pathToId = _interopRequireDefault(require(\"./pathToId\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n        Story with id \", \" already exists in the store!\\n\\n        Perhaps you added the same story twice, or you have a name collision?\\n        Story ids need to be unique -- ensure you aren't using the same names modolo url-sanitization.\\n      \"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n// TODO: these are copies from components/nav/lib\n// refactor to DRY\nvar toKey = function toKey(input) {\n  return input.replace(/[^a-z0-9]+([a-z0-9])/gi, function () {\n    for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {\n      params[_key] = arguments[_key];\n    }\n\n    return params[1].toUpperCase();\n  });\n};\n\nvar toChild = function toChild(it) {\n  return Object.assign({}, it);\n};\n\nvar splitPath = function splitPath(path, _ref) {\n  var rootSeparator = _ref.rootSeparator,\n      groupSeparator = _ref.groupSeparator;\n\n  var _path$split = path.split(rootSeparator, 2),\n      _path$split2 = _slicedToArray(_path$split, 2),\n      root = _path$split2[0],\n      remainder = _path$split2[1];\n\n  var groups = (remainder || path).split(groupSeparator).filter(function (i) {\n    return !!i;\n  }); // when there's no remainder, it means the root wasn't found/split\n\n  return {\n    root: remainder ? root : null,\n    groups: groups\n  };\n};\n\nexports.splitPath = splitPath;\nvar count = 0;\n\nfunction getId() {\n  count += 1;\n  return count;\n}\n\nvar toExtracted = function toExtracted(obj) {\n  return Object.entries(obj).reduce(function (acc, _ref2) {\n    var _ref3 = _slicedToArray(_ref2, 2),\n        key = _ref3[0],\n        value = _ref3[1];\n\n    if (typeof value === 'function') {\n      return acc;\n    }\n\n    if (Array.isArray(value)) {\n      return Object.assign(acc, _defineProperty({}, key, value.slice().sort()));\n    }\n\n    return Object.assign(acc, _defineProperty({}, key, value));\n  }, {});\n};\n\nvar getIdFromLegacyQuery = function getIdFromLegacyQuery(_ref4) {\n  var path = _ref4.path,\n      selectedKind = _ref4.selectedKind,\n      selectedStory = _ref4.selectedStory;\n  return path && (0, _pathToId.default)(path) || selectedKind && selectedStory && (0, _utils.toId)(selectedKind, selectedStory);\n};\n\nvar StoryStore =\n/*#__PURE__*/\nfunction (_EventEmitter) {\n  _inherits(StoryStore, _EventEmitter);\n\n  function StoryStore(_ref5) {\n    var _this;\n\n    var channel = _ref5.channel;\n\n    _classCallCheck(this, StoryStore);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(StoryStore).call(this));\n\n    _this.getIdOnPath = function () {\n      var _qs$parse = _qs.default.parse(_global.document.location.search, {\n        ignoreQueryPrefix: true\n      }),\n          id = _qs$parse.id;\n\n      return id;\n    };\n\n    _this.setPath = function (storyId) {\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var path = \"\".concat(_global.document.location.pathname, \"?\").concat(_qs.default.stringify(Object.assign({}, params, {\n        id: storyId\n      })));\n\n      _global.history.replaceState({}, '', path);\n    };\n\n    _this.fromId = function (id) {\n      try {\n        var data = _this._data[id];\n\n        if (!data || !data.getDecorated) {\n          return null;\n        }\n\n        return data;\n      } catch (e) {\n        _clientLogger.logger.warn('failed to get story:', _this._data);\n\n        _clientLogger.logger.error(e);\n\n        return {};\n      }\n    };\n\n    _this.setSelection = function (data) {\n      _this._selection = data;\n      setTimeout(function () {\n        return _this.emit(_coreEvents.default.STORY_RENDER);\n      }, 1);\n    };\n\n    _this.getSelection = function () {\n      return _this._selection;\n    };\n\n    _this.remove = function (id) {\n      var _assertThisInitialize = _assertThisInitialized(_this),\n          _data = _assertThisInitialize._data;\n\n      delete _data[id];\n    };\n\n    _this.pushToManager = (0, _lodash.default)(function () {\n      if (_this._channel) {\n        var stories = _this.extract(); // send to the parent frame.\n\n\n        _this._channel.emit(_coreEvents.default.SET_STORIES, {\n          stories: stories\n        });\n      }\n    }, 0);\n    _this._legacydata = {};\n    _this._data = {};\n    _this._revision = 0;\n    _this._selection = {};\n    _this._channel = channel;\n\n    _this.on(_coreEvents.default.STORY_INIT, function () {\n      var storyId = _this.getIdOnPath();\n\n      if (!storyId) {\n        var params = _qs.default.parse(_global.document.location.search, {\n          ignoreQueryPrefix: true\n        });\n\n        storyId = getIdFromLegacyQuery(params);\n\n        if (storyId) {\n          var path = params.path,\n              selectedKind = params.selectedKind,\n              selectedStory = params.selectedStory,\n              rest = _objectWithoutProperties(params, [\"path\", \"selectedKind\", \"selectedStory\"]);\n\n          _this.setPath(storyId, rest);\n        }\n      }\n\n      _this.setSelection(_this.fromId(storyId));\n    });\n\n    return _this;\n  } // NEW apis\n\n\n  _createClass(StoryStore, [{\n    key: \"setSeparators\",\n    value: function setSeparators(data) {\n      this.separators = data;\n    }\n  }, {\n    key: \"raw\",\n    value: function raw() {\n      var _this2 = this;\n\n      return Object.values(this._data).filter(function (i) {\n        return !!i.getDecorated;\n      }).map(function (_ref6) {\n        var id = _ref6.id;\n        return _this2.fromId(id);\n      });\n    }\n  }, {\n    key: \"extract\",\n    value: function extract() {\n      // removes function values from all stories so they are safe to transport over the channel\n      return Object.entries(this._data).reduce(function (a, _ref7) {\n        var _ref8 = _slicedToArray(_ref7, 2),\n            k = _ref8[0],\n            v = _ref8[1];\n\n        return Object.assign(a, _defineProperty({}, k, toExtracted(v)));\n      }, {});\n    }\n  }, {\n    key: \"addStory\",\n    value: function addStory(_ref9, _ref10) {\n      var id = _ref9.id,\n          kind = _ref9.kind,\n          name = _ref9.name,\n          original = _ref9.storyFn,\n          _ref9$parameters = _ref9.parameters,\n          parameters = _ref9$parameters === void 0 ? {} : _ref9$parameters;\n      var getDecorators = _ref10.getDecorators,\n          applyDecorators = _ref10.applyDecorators;\n      var _data = this._data;\n\n      if (_data[id]) {\n        _clientLogger.logger.warn((0, _commonTags.stripIndents)(_templateObject(), id));\n      }\n\n      var identification = {\n        id: id,\n        kind: kind,\n        name: name,\n        story: name // legacy\n\n      }; // immutable original storyFn\n\n      var getOriginal = function getOriginal() {\n        return original;\n      }; // lazily decorate the story when it's loaded\n\n\n      var getDecorated = (0, _memoizerific.default)(1)(function () {\n        return applyDecorators(getOriginal(), getDecorators());\n      });\n\n      var storyFn = function storyFn(p) {\n        return getDecorated()(Object.assign({}, identification, {\n          parameters: Object.assign({}, parameters, p)\n        }));\n      };\n\n      _data[id] = toChild(Object.assign({}, identification, {\n        getDecorated: getDecorated,\n        getOriginal: getOriginal,\n        storyFn: storyFn,\n        parameters: parameters\n      })); // LEGACY DATA\n\n      this.addLegacyStory({\n        kind: kind,\n        name: name,\n        storyFn: storyFn,\n        parameters: parameters\n      }); // LET'S SEND IT TO THE MANAGER\n\n      this.pushToManager();\n    }\n  }, {\n    key: \"getRevision\",\n    // OLD apis\n    value: function getRevision() {\n      return this._revision;\n    }\n  }, {\n    key: \"incrementRevision\",\n    value: function incrementRevision() {\n      this._revision += 1;\n    }\n  }, {\n    key: \"addLegacyStory\",\n    value: function addLegacyStory(_ref11) {\n      var kind = _ref11.kind,\n          name = _ref11.name,\n          storyFn = _ref11.storyFn,\n          _ref11$parameters = _ref11.parameters,\n          parameters = _ref11$parameters === void 0 ? {} : _ref11$parameters;\n      var k = toKey(kind);\n\n      if (!this._legacydata[k]) {\n        this._legacydata[k] = {\n          kind: kind,\n          fileName: parameters.fileName,\n          index: getId(),\n          stories: {}\n        };\n      }\n\n      this._legacydata[k].stories[toKey(name)] = {\n        name: name,\n        // kind,\n        index: getId(),\n        story: storyFn,\n        parameters: parameters\n      };\n    }\n  }, {\n    key: \"getStoryKinds\",\n    value: function getStoryKinds() {\n      return Object.values(this._legacydata).filter(function (kind) {\n        return Object.keys(kind.stories).length > 0;\n      }).sort(function (info1, info2) {\n        return info1.index - info2.index;\n      }).map(function (info) {\n        return info.kind;\n      });\n    }\n  }, {\n    key: \"getStories\",\n    value: function getStories(kind) {\n      var _this3 = this;\n\n      var key = toKey(kind);\n\n      if (!this._legacydata[key]) {\n        return [];\n      }\n\n      return Object.keys(this._legacydata[key].stories).map(function (name) {\n        return _this3._legacydata[key].stories[name];\n      }).sort(function (info1, info2) {\n        return info1.index - info2.index;\n      }).map(function (info) {\n        return info.name;\n      });\n    }\n  }, {\n    key: \"getStoryFileName\",\n    value: function getStoryFileName(kind) {\n      var key = toKey(kind);\n      var storiesKind = this._legacydata[key];\n\n      if (!storiesKind) {\n        return null;\n      }\n\n      return storiesKind.fileName;\n    }\n  }, {\n    key: \"getStoryAndParameters\",\n    value: function getStoryAndParameters(kind, name) {\n      if (!kind || !name) {\n        return null;\n      }\n\n      var storiesKind = this._legacydata[toKey(kind)];\n\n      if (!storiesKind) {\n        return null;\n      }\n\n      var storyInfo = storiesKind.stories[toKey(name)];\n\n      if (!storyInfo) {\n        return null;\n      }\n\n      var story = storyInfo.story,\n          parameters = storyInfo.parameters;\n      return {\n        story: story,\n        parameters: parameters\n      };\n    }\n  }, {\n    key: \"getStory\",\n    value: function getStory(kind, name) {\n      var data = this.getStoryAndParameters(kind, name);\n      return data && data.story;\n    }\n  }, {\n    key: \"getStoryWithContext\",\n    value: function getStoryWithContext(kind, name) {\n      var data = this.getStoryAndParameters(kind, name);\n\n      if (!data) {\n        return null;\n      }\n\n      var story = data.story;\n      return story;\n    }\n  }, {\n    key: \"removeStoryKind\",\n    value: function removeStoryKind(kind) {\n      if (this.hasStoryKind(kind)) {\n        this._legacydata[toKey(kind)].stories = {};\n      }\n    }\n  }, {\n    key: \"hasStoryKind\",\n    value: function hasStoryKind(kind) {\n      return Boolean(this._legacydata[toKey(kind)]);\n    }\n  }, {\n    key: \"hasStory\",\n    value: function hasStory(kind, name) {\n      return Boolean(this.getStory(kind, name));\n    }\n  }, {\n    key: \"dumpStoryBook\",\n    value: function dumpStoryBook() {\n      var _this4 = this;\n\n      var data = this.getStoryKinds().map(function (kind) {\n        return {\n          kind: kind,\n          stories: _this4.getStories(kind)\n        };\n      });\n      return data;\n    }\n  }, {\n    key: \"size\",\n    value: function size() {\n      return Object.keys(this._legacydata).length;\n    }\n  }, {\n    key: \"clean\",\n    value: function clean() {\n      var _this5 = this;\n\n      this.getStoryKinds().forEach(function (kind) {\n        return delete _this5._legacydata[toKey(kind)];\n      });\n    }\n  }]);\n\n  return StoryStore;\n}(_eventemitter.default);\n\nexports.default = StoryStore;"],"mappings":"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"},"metadata":{},"sourceType":"script"}